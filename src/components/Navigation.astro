---
// Define the current path to handle active states
const pathname = new URL(Astro.request.url).pathname;
const currentPath = pathname.slice(1); // Remove the leading slash
---

<div class="fixed top-0 left-0 right-0 z-50 px-[20px] pt-[20px] transform transition-transform duration-300 ease-in-out" id="navigation">
  <nav class="bg-light-grey/90 dark:bg-dark-surface/90 backdrop-blur-sm rounded-[4px]">
    <div class="px-[20px] py-[8px]">
      <div class="flex items-center justify-between">
        <!-- Logo/Home link -->
        <a href="/" class="text-black dark:text-dark-text">
          <span class="text-[14px] font-semibold">Anton Sten</span>
        </a>

        <!-- Main navigation -->
        <div class="hidden md:flex items-center gap-2">
          <a 
            href="/about" 
            class={`text-[14px] font-semibold text-black dark:text-dark-text hover:bg-white dark:hover:bg-dark-border px-3 py-1 rounded-[4px] transition-colors ${currentPath === 'about' ? 'bg-white dark:bg-dark-border' : ''}`}
          >
            About
          </a>
          <a 
            href="/articles" 
            class={`text-[14px] font-semibold text-black dark:text-dark-text hover:bg-white dark:hover:bg-dark-border px-3 py-1 rounded-[4px] transition-colors ${currentPath === 'articles' ? 'bg-white dark:bg-dark-border' : ''}`}
          >
            Articles
          </a>
          <a 
            href="/work" 
            class={`text-[14px] font-semibold text-black dark:text-dark-text hover:bg-white dark:hover:bg-dark-border px-3 py-1 rounded-[4px] transition-colors ${currentPath === 'work' ? 'bg-white dark:bg-dark-border' : ''}`}
          >
            Work
          </a>
          <a 
            href="/coaching" 
            class={`text-[14px] font-semibold text-black dark:text-dark-text hover:bg-white dark:hover:bg-dark-border px-3 py-1 rounded-[4px] transition-colors ${currentPath === 'coaching' ? 'bg-white dark:bg-dark-border' : ''}`}
          >
            Coaching
          </a>
          <a 
            href="/newsletter" 
            class={`text-[14px] font-semibold text-black dark:text-dark-text hover:bg-white dark:hover:bg-dark-border px-3 py-1 rounded-[4px] transition-colors ${currentPath === 'newsletter' ? 'bg-white dark:bg-dark-border' : ''}`}
          >
            Newsletter
          </a>
        </div>

        <!-- Mobile menu button -->
        <button 
          class="md:hidden text-[14px] font-semibold text-black dark:text-dark-text flex items-center gap-2"
          aria-label="Toggle menu"
          id="menuButton"
        >
          Menu
          <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M4 6H20M4 12H20M4 18H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>

      <!-- Mobile menu -->
      <div 
        class="hidden md:hidden pt-4 pb-6 border-t border-gray-200 dark:border-dark-border mt-4"
        id="mobileMenu"
      >
        <div class="flex flex-col space-y-4">
          <a 
            href="/about" 
            class={`text-[14px] font-semibold text-black dark:text-dark-text hover:bg-white dark:hover:bg-dark-border px-3 py-1 rounded-[4px] transition-colors ${currentPath === 'about' ? 'bg-white dark:bg-dark-border' : ''}`}
          >
            About
          </a>
          <a 
            href="/articles" 
            class={`text-[14px] font-semibold text-black dark:text-dark-text hover:bg-white dark:hover:bg-dark-border px-3 py-1 rounded-[4px] transition-colors ${currentPath === 'articles' ? 'bg-white dark:bg-dark-border' : ''}`}
          >
            Articles
          </a>
          <a 
            href="/work" 
            class={`text-[14px] font-semibold text-black dark:text-dark-text hover:bg-white dark:hover:bg-dark-border px-3 py-1 rounded-[4px] transition-colors ${currentPath === 'work' ? 'bg-white dark:bg-dark-border' : ''}`}
          >
            Work
          </a>
          <a 
            href="/coaching" 
            class={`text-[14px] font-semibold text-black dark:text-dark-text hover:bg-white dark:hover:bg-dark-border px-3 py-1 rounded-[4px] transition-colors ${currentPath === 'coaching' ? 'bg-white dark:bg-dark-border' : ''}`}
          >
            Coaching
          </a>
          <a 
            href="/newsletter" 
            class={`text-[14px] font-semibold text-black dark:text-dark-text hover:bg-white dark:hover:bg-dark-border px-3 py-1 rounded-[4px] transition-colors ${currentPath === 'newsletter' ? 'bg-white dark:bg-dark-border' : ''}`}
          >
            Newsletter
          </a>
        </div>
      </div>
    </div>
  </nav>
</div>

<script>
  // Mobile menu toggle
  const menuButton = document.getElementById('menuButton');
  const mobileMenu = document.getElementById('mobileMenu');
  const menuIcon = menuButton?.querySelector('svg');

  menuButton?.addEventListener('click', () => {
    mobileMenu?.classList.toggle('hidden');
    const button = menuButton as HTMLButtonElement;
    button.textContent = button.textContent === 'Menu' ? 'Close' : 'Menu';
    
    // Rotate the menu icon
    if (menuIcon) {
      menuIcon.style.transform = button.textContent === 'Close' ? 'rotate(180deg)' : 'rotate(0deg)';
      menuIcon.style.transition = 'transform 0.3s ease';
    }
  });

  // Navigation scroll behavior
  let lastScrollY = window.scrollY;
  let isScrollingUp = false;
  const navigation = document.getElementById('navigation');

  window.addEventListener('scroll', () => {
    const currentScrollY = window.scrollY;
    
    // Determine scroll direction
    if (currentScrollY < lastScrollY) {
      // Scrolling up
      isScrollingUp = true;
    } else if (currentScrollY > lastScrollY) {
      // Scrolling down
      isScrollingUp = false;
    }

    // Show/hide navigation based on scroll direction and position
    if (navigation) {
      if (currentScrollY <= 20) {
        // Always show when at top of page
        navigation.style.transform = 'translateY(0)';
      } else if (isScrollingUp) {
        // Show when scrolling up
        navigation.style.transform = 'translateY(0)';
      } else {
        // Hide when scrolling down
        navigation.style.transform = 'translateY(-100%)';
      }
    }

    lastScrollY = currentScrollY;
  });
</script> 